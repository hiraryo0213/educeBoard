!function(t){var a="unitySyncData",e={initialize:function(i){return this.each(function(){t(this).data(a,t.extend(!0,{unityObject:null,$IDDOM:t(this).find("[data-"+a+'-parts="sendID"]'),$seekbar:t(this).find("[data-"+a+'-parts="seekbar"]'),$timeLength:t(this).find("[data-"+a+'-parts="timeLength"]'),$position:t(this).find("[data-"+a+'-parts="position"]'),$playButton:t(this).find("[data-"+a+'-parts="playButton"]'),$timeView:t(this).find("[data-"+a+'-parts="timeView"]'),$loadingState:t(this).find("[data-"+a+'-parts="loadingState"]'),$progress:t(this).find("[data-"+a+'-parts="progress"]'),$errorMessage:t(this).find("[data-"+a+'-parts="errorMessage"]'),nowTime:0,prevTime:0,id:null,xmlLoadedFlag:0,isPlay:0,soundLength:null,seekbarWidth:0,positionWidth:0,sendFlag:!1,voiceLoaded:0,xmlLoaded:0,beforeProgress:0,$loadOverlay:t(this).find("[data-"+a+'-parts="loadOverlay"]'),noTransitionClass:"elNoAnimation",afterTimeAppend:null,afterRecieveXMLLoadedFlag:null,resultTimePosition:null},i));var n=t(this),s=n.data(a);s.seekbarWidth=s.$seekbar.width(),s.positionWidth=s.$position.width(),e.setUnityObject.apply(n)})},setUnityObject:function(){var i=t(this),n=i.data(a),s=n.unityObject;s.initPlugin(t("#unityPlayer")[0],"../unity/EduceBoard.unity3d"),window.UnityLoadFlag=function(t){1===t&&null===n.id?n.sendFlag=!0:(n.unityObject.getUnity().SendMessage("Loader","GetSID",n.id.sessionId),n.unityObject.getUnity().SendMessage("Loader","GetTID",n.id.trialId))},e.sendID.apply(i),e.setProgress.apply(i),e.recieveTime.apply(i),e.recieveXMLLoadedFlag.apply(i),e.recieveTimeLength.apply(i)},sendID:function(){var e=t(this),i=e.data(a);e.on("click."+a,i.$IDDOM.selector,function(a){i.id=t(a.target).data().id;var e=t("body").data("educeboardBasicInfo");t("body").data("educeboardBasicInfo",t.extend(e,{sid:i.id.sessionId,tid:i.id.trialId})),i.$loadOverlay.attr("aria-hidden",!1),i.sendFlag&&(i.unityObject.getUnity().SendMessage("Loader","GetSID",i.id.sessionId),i.unityObject.getUnity().SendMessage("Loader","GetTID",i.id.trialId))})},recieveTime:function(){var i,n=t(this),s=n.data(a);window.soundPosition=function(t){s.nowTime=t,i=s.prevTime,i!=parseInt(t)&&(e.timeAppend.apply(n),null!==soundLength&&e.movePosition.apply(n))}},movePosition:function(){var e=t(this),i=e.data(a),n=i.soundLength,s=i.nowTime,o=i.$timeLength,d=i.$position,r=i.seekbarWidth,l=i.positionWidth,p=0,u=0;null!==n&&(p=s/n,u=r*p+.5*l,o.hasClass(i.noTransitionClass)&&o.toggleClass(i.noTransitionClass,!1),d.hasClass(i.noTransitionClass)&&d.toggleClass(i.noTransitionClass,!1),o.css({width:u-.5*l+"px"}),d.css({left:u+"px"}))},resultTimePosition:function(){var i=t(this),n=i.data(a),s=n.soundLength,o=n.$position,d=(n.$timeLength,n.seekbarWidth),r=(n.positionWidth,parseFloat(o[0].style.left)),l=r/d*s;n.unityObject.getUnity().SendMessage("XMLLoader","soundPosition",l),e.applyCallback.apply([i,"resultTimePosition"])},timeLengthUpdate:function(){var e,i=t(this),n=i.data(a),s=n.$position,o=n.$timeLength,d=0,r=0,l=["transform","msTransform","MozTransform","webkitTransform"],p=l.length;for(e=0;p>e;e++)if(s[0].style[l[e]]){d=s[0].style[l[e]],d=d.substring(d.indexOf("(")+1,d.indexOf(","));break}r=s[0].style.left;var u=parseFloat(r)+parseFloat(d);o[0].style.width=u+"px"},timeAppend:function(){var n=t(this),s=n.data(a),o=s.prevTime,d=s.nowTime,r=s.$timeView,l=[0,0,0];if(d=parseInt(d),d!=o){l[2]=d,l[1]=parseInt(l[2]/60),l[0]=parseInt(l[1]/60),l[1]=l[1]-60*l[0],l[2]=l[2]-60*l[1];var p="",u=l.length;for(i=0;i<u;i++)l[i]<10&&(l[i]="0"+l[i]),p+=l[i],i!=u-1&&(p+=":");r.text(p).attr("data-"+a+"-time",d),s.prevTime=d,e.applyCallback.apply([n,"afterTimeAppend"])}},recieveTimeLength:function(){var e=t(this),i=e.data(a);window.soundLength=function(t){i.soundLength=t}},recieveXMLLoadedFlag:function(){var i=t(this),n=i.data(a);window.xmlLoadFlag=function(t){n.xmlLoadedFlag=t,1==t?(e.setEvent.apply(i),e.playToggle.apply(i),n.$loadOverlay.attr("aria-hidden",!0),e.applyCallback.apply([i,"afterRecieveXMLLoadedFlag"])):-1==t&&(n.$loadingState.attr("aria-hidden",!0),n.$errorMessage.attr("aria-hidden",!1))}},setEvent:function(){var i=t(this),n=i.data(a),s=n.$playButton,o=n.$position,d=n.$timeLength;i.on("click."+a,s.selector,function(t){t.preventDefault(),e.playToggle.apply(i)}),i.on("mousedown."+a,o.selector,function(t){t.preventDefault(),n.isPlay=1,e.playToggle.apply(i),o.toggleClass(n.noTransitionClass,!0),d.toggleClass(n.noTransitionClass,!0),i.on("mouseup."+a,function(t){i.off("mouseup."+a),t.preventDefault(),n.isPlay=0,e.playToggle.apply(i),e.applyCallback.apply([i,"resultTimePosition"])})})},playToggle:function(){var e=t(this),i=e.data(a),n=i.isPlay,s=i.$playButton,o=s.find("[data-"+a+'-parts="play"]'),d=s.find("[data-"+a+'-parts="pause"]');i.isPlay=0==n?1:0,1==i.isPlay?(o.attr("aria-hidden",!0),d.attr("aria-hidden",!1)):(o.attr("aria-hidden",!1),d.attr("aria-hidden",!0)),i.unityObject.getUnity().SendMessage("XMLLoader","playFlag",i.isPlay)},setProgress:function(){var i=t(this),n=i.data(a);window.voiceProgress=function(t){n.voiceLoaded=100*t,e.progressCalc.apply(i)},window.xmlProgress=function(t){n.xmlLoaded=100*t,e.progressCalc.apply(i)}},progressCalc:function(){var e=t(this),i=e.data(a),n=i.voiceLoaded,s=i.xmlLoaded,o=parseInt(.5*(n+s)),d=i.$progress,r=i.beforeProgress;o!==r&&(d.css({width:o+"%"}),d.text(o+"%"),i.beforeProgress=o)},applyCallback:function(){var e=t(this)[0],i=e.data(a),n=t(this)[1];"function"==typeof i[n]&&i[n]()},destroy:function(){}};t.fn[a]=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void 0:e.initialize.apply(this,arguments)}}(jQuery);